# Influenza A Prediction using Wastewater Surveillance Data

## Project Overview

This project aims to predict the presence of **Influenza A virus** in wastewater samples collected across the United States. By analyzing viral RNA levels along with environmental and demographic factors, we developed a machine learning pipeline to classify samples as **"Flu Detected"** or **"Not Detected"**.

The project compares the performance of linear and probabilistic models (**SGDClassifier** vs. **GaussianNB**) and evaluates the impact of **Dimensionality Reduction (PCA)** on model performance.


## Dataset

The data is sourced from the **CDC (Centers for Disease Control and Prevention) National Wastewater Surveillance System (NWSS)**.

  * **Target Variable:** `influenza_a_detected` (Binary: 0 or 1) derived from viral RNA concentrations.
  * **Features:** Flow rate, population served, wastewater recovery efficiency, temporal data, and geographical jurisdiction.


## Methodology & Workflow

### 1\. Data Cleaning & Preprocessing

  * **Deduplication:** Removed duplicate entries.
  * **Outlier Handling:** Capped abnormal values (e.g., `rec_eff_percent` \> 100%).
  * **Imputation:**
      * Numerical missing values filled with **Median**.
      * Categorical missing values filled with **Mode**.
  * **Scaling:** Applied **StandardScaler** to normalize all numerical features.

### 2\. Feature Engineering (Key Innovations)

We created domain-specific features to enhance model interpretability:

  * **`season`:** Mapped months to seasons (Winter, Spring, Summer, Fall) to capture the seasonal nature of the flu.
  * **`is_weekend`:** Binary flag (0/1) to account for behavioral changes on weekends.
  * **`log_flow_per_capita`:** An interaction feature combining flow rate and population.
  * **`population_group`:** Binned population sizes into ordinal categories (Small, Medium, Large, Very Large).
  * **Transformations:** Applied `Log1p` transformation to skewed features like `population_served`.

### 3\. Dimensionality Reduction

  * **PCA (Principal Component Analysis):** Applied to reduce the feature space while retaining **95% of the variance**.
  * Models were trained both **with** and **without** PCA to compare efficiency and accuracy.

## Models Used

We avoided ensemble methods (like Random Forest) for the base models to test fundamental algorithmic differences:

1.  **SGDClassifier (Stochastic Gradient Descent):**
      * *Family:* Linear Models.
      * *Why:* Efficient for large datasets, interpretable coefficients.
2.  **GaussianNB (Naive Bayes):**
      * *Family:* Probabilistic Models.
      * *Why:* Fast training, effective baseline for classification tasks.

### Visualizations

The project includes detailed visualizations generated by `matplotlib` and `seaborn`:

  * **ROC & Precision-Recall Curves:** Comparing model performance.
  * **Confusion Matrices:** Visualizing True Positives vs. False Negatives.
  * **Feature Importance:**
      * *Original Features:* Absolute coefficients for SGD and mean differences for Naive Bayes.
      * *PCA Components:* Contribution of principal components to the decision boundary.


## How to Run

1.  **Clone the repository:**
    ```bash
    git clone https://github.com/your-username/CDC-Wastewater-Influenza-Prediction.git
    ```
2.  **Install dependencies:**
    ```bash
    pip install pandas numpy matplotlib seaborn scikit-learn
    ```
3.  **Run the Notebook:**
    Open `veri_madenciligi_odev.ipynb` in Jupyter Notebook or VS Code and run all cells.
